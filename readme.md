멀티 스레드로 처리시 레이스 컨디션이 일어나는 이유
 - 같은 데이터를 동시에 변경하려 하기 때문

> Race Condition이란
2이상의 스레드가 공유 데이터에 액서스 할 수 있고 동시에 변경하려 할 때 발생할 수 있는 문제이다.

이를 해결하기 위해서는 하나의 스레드가 작업이 끝나고 다른 쓰레드가 공유된 자원에 접근 가능하도록 해야 한다.

Race Condition 해결 방법

1. Synchronized 이용
 - 하나의 스레드만 접근이 가능하게 해준다
 - 멀티 스레드 환경에서 스레드간 데이터 동기화를 시켜주기 위해 자바에서 제공되는 키워드이다.
 - 현재 데이터를 사용하고 있는 해당 스레드를 제외하고 나머지 스레드들은 데이터 접근을 막아 순차적으로 데이터에 접근할 수 있도록 한다.
 - 그러나 하나의 프로세스 안에서만 보장이 된다.
   - 서버가 한대라면 문제가 없는데 서버가 두대 이상이면 데이터 동시 접근을 막을 수 없다.

2. Database 이용하기 (Lock 걸어버리기)
- 베타적 접근을 걸어 다른 트랜잭션에서는 lock이 해제되기 전에 데이터를 가져갈 수 없게 된다.
- 비관적 락 : 지원 요청시 동시성 문제가 발생할 것이라고 예상하고 락을 걸어버림
- 낙관적 락 : 자원에 락을 걸어 선점하지 않고 동시성 문제가 발생하면 그때 가서 처리하는 방식
- Named Lock : 이름을 가진 metadata locking으로 이름을 가진 lock를 획득하고 해제할 때까지 다른 세션은 이 lock을 획득할 수 없도록 한다.

3. Distributed Lock - Lettuce의 사용
- setnx 명령어를 사용하여 분산락을 구현한 방식
- spin lock 방식으로 구현 - 락을 해제할 수 있는지 일정 주기에 따라 확인하는 방법이다.
- Redis를 활용하므로 트랜잭션에 따라 대응되는 현재 트랜잭션 풀 세션관리를 하지 않아도 됨
- Spin Lock 방식이므로 sleep Time을 적절히 조절하여 Redis 부하를 조절해야 한다.
- 반드시 수동으로 unLock를 해주어야 한다.

4. Distributed Lock - Redisson의 사용
- pub-sub 기반으로 Lock를  구현, 채널을 하나 만들고 락을 점유하고 있는 쓰레드가 락을 받으려는 쓰레드에게 점유 해제를 공지하는 식으로 작동한다.
- leaseTime을 잘못 잡으면 작업 도중 Lock이 해제될 수 있으니(...) 주의하도록 한다.
  - leaseTime을 1초로 잡았는데 작업이 2초가 걸리는 경우